<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.4.551">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Connor Robertson">

<title>Connor Robertson - Lab 4 - Secant method</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="../../../../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../../../../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../../../../site_libs/clipboard/clipboard.min.js"></script>
<script src="../../../../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../../../../site_libs/quarto-search/fuse.min.js"></script>
<script src="../../../../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../../../../">
<link href="../../../../assets/circle-svgrepo-com.svg" rel="icon" type="image/svg+xml">
<script src="../../../../site_libs/quarto-html/quarto.js"></script>
<script src="../../../../site_libs/quarto-html/popper.min.js"></script>
<script src="../../../../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../../../../site_libs/quarto-html/anchor.min.js"></script>
<link href="../../../../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../../../../site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-text-highlighting-styles">
<link href="../../../../site_libs/quarto-html/quarto-syntax-highlighting-dark.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-text-highlighting-styles">
<script src="../../../../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../../../../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../../../../site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" class="quarto-color-scheme" id="quarto-bootstrap" data-mode="light">
<link href="../../../../site_libs/bootstrap/bootstrap-dark.min.css" rel="prefetch" class="quarto-color-scheme quarto-color-alternate" id="quarto-bootstrap" data-mode="dark">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

<link rel="stylesheet" href="../../../../styles.css">
</head>

<body class="nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="../../../../index.html">
    <span class="navbar-title">Connor Robertson</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="../../../../cv.html"> 
<span class="menu-text">CV</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="../../../../research/research.html"> 
<span class="menu-text">Research</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-other" role="button" data-bs-toggle="dropdown" aria-expanded="false">
 <span class="menu-text">Other</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-other">    
        <li>
    <a class="dropdown-item" href="../../../../other/fun/fun.html">
 <span class="dropdown-text">Just for Fun</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../other/mlseminar/mlseminar.html">
 <span class="dropdown-text">Machine Learning and Optimization Seminar</span></a>
  </li>  
        <li>
    <a class="dropdown-item" href="../../../../other/teaching/teaching.html">
 <span class="dropdown-text">NJIT Teaching</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
          <div class="quarto-navbar-tools">
  <a href="" class="quarto-color-scheme-toggle quarto-navigation-tool  px-1" onclick="window.quartoToggleColorScheme(); return false;" title="Toggle dark mode"><i class="bi"></i></a>
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#secant-method" id="toc-secant-method" class="nav-link active" data-scroll-target="#secant-method">Secant method</a>
  <ul class="collapse">
  <li><a href="#pseudocode" id="toc-pseudocode" class="nav-link" data-scroll-target="#pseudocode">Pseudocode</a></li>
  <li><a href="#convergence" id="toc-convergence" class="nav-link" data-scroll-target="#convergence">Convergence</a></li>
  </ul></li>
  <li><a href="#regula-falsi" id="toc-regula-falsi" class="nav-link" data-scroll-target="#regula-falsi">Regula Falsi</a>
  <ul class="collapse">
  <li><a href="#pseudocode-1" id="toc-pseudocode-1" class="nav-link" data-scroll-target="#pseudocode-1">Pseudocode</a></li>
  <li><a href="#convergence-1" id="toc-convergence-1" class="nav-link" data-scroll-target="#convergence-1">Convergence</a></li>
  </ul></li>
  <li><a href="#comparison-of-root-finding-methods" id="toc-comparison-of-root-finding-methods" class="nav-link" data-scroll-target="#comparison-of-root-finding-methods">Comparison of root finding methods</a></li>
  <li><a href="#examples" id="toc-examples" class="nav-link" data-scroll-target="#examples">Examples</a>
  <ul class="collapse">
  <li><a href="#regula-falsi-1" id="toc-regula-falsi-1" class="nav-link" data-scroll-target="#regula-falsi-1">Regula falsi</a></li>
  <li><a href="#finding-a-quantile-of-a-probability-distributions" id="toc-finding-a-quantile-of-a-probability-distributions" class="nav-link" data-scroll-target="#finding-a-quantile-of-a-probability-distributions">Finding a quantile of a probability distributions</a></li>
  </ul></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Lab 4 - Secant method</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Connor Robertson </p>
          </div>
  </div>
    
  
    
  </div>
  


</header>


<section id="secant-method" class="level2">
<h2 class="anchored" data-anchor-id="secant-method">Secant method</h2>
<p>There is an alternative to Newton’s method that does not require a closed form for <span class="math inline">\(f'(x)\)</span> called “Secant method.” Although the method is presented from the context of Newton’s method, it actually predates it by thousands of years. In order to understand it as it relates to Newton’s method, we can consider the definition of the derivative <span class="math inline">\(f'(x)\)</span>: <span class="math display">\[
\begin{align*}
    f'(x) = \lim_{\delta \to 0} \frac{f(x) - f(x-\delta)}{\delta}
.\end{align*}
\]</span> We can rewrite this as: <span class="math display">\[
\begin{align*}
    f'(x) = \lim_{\delta \to 0} \frac{f(x) - f(x-\delta)}{x - (x - \delta)}
.\end{align*}
\]</span> Taking a fixed small number <span class="math inline">\(\delta\)</span> and plugging in some value <span class="math inline">\(x_n\)</span> where <span class="math inline">\(x_n - \delta \approx x_{n-1}\)</span> to get: <span class="math display">\[
\begin{align*}
    f'(x_n) \approx \frac{f(x_n) - f(x_{n-1})}{x_n - x_{n-1}}
.\end{align*}
\]</span> This is called the “secant line” at <span class="math inline">\(x_n\)</span>. If we now plug in this derivative approximation to Newton’s method, we get: <span class="math display">\[
\begin{align*}
    g(x_n, x_{n-1}) = x_n - f(x_n) \frac{x_n - x_{n-1}}{f(x_n) - f(x_{n-1})}
\end{align*}
\]</span> which is the secant method without an explicit form for <span class="math inline">\(f'(x)\)</span>! Although this has simplified our procedure, there are also some drawbacks in convergence.</p>
<section id="pseudocode" class="level3">
<h3 class="anchored" data-anchor-id="pseudocode">Pseudocode</h3>
<p>Given two initial points <span class="math inline">\(x1\)</span> and <span class="math inline">\(x2\)</span>, the fixed point function <span class="math inline">\(g\)</span> (that takes in variables for <span class="math inline">\(x_n\)</span> and <span class="math inline">\(x_{n-1}\)</span>), an ending tolerance <span class="math inline">\(tol\)</span>, and a max number of steps <span class="math inline">\(Nmax\)</span>, we compute:</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a><span class="va">i</span> <span class="op">=</span> <span class="fl">2</span><span class="op">;</span>            <span class="co">% Counter variable</span></span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="va">xs</span> <span class="op">=</span> [<span class="va">x1</span><span class="op">,</span> <span class="va">x2</span>]<span class="op">;</span>    <span class="co">% Array for storing results</span></span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="kw">while</span> <span class="va">abs</span>(<span class="va">xs</span>(<span class="va">i</span>)<span class="op">-</span><span class="va">xs</span>(<span class="va">i</span><span class="op">-</span><span class="fl">1</span>)) <span class="op">&gt;</span> <span class="va">tol</span> <span class="op">&amp;&amp;</span> <span class="va">i</span> <span class="op">&lt;</span> <span class="va">Nmax</span></span>
<span id="cb1-4"><a href="#cb1-4" aria-hidden="true" tabindex="-1"></a>    <span class="co">% Append  g(xs(i),xs(i-1)) to xs</span></span>
<span id="cb1-5"><a href="#cb1-5" aria-hidden="true" tabindex="-1"></a>    <span class="co">% Add 1 to i</span></span>
<span id="cb1-6"><a href="#cb1-6" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</section>
<section id="convergence" class="level3">
<h3 class="anchored" data-anchor-id="convergence">Convergence</h3>
<p>Firstly, because the secant method can be viewed as an approximation of Newton’s method, it is sensitive to the starting value <span class="math inline">\(x_1\)</span> like Newton’s method. Specifically, if the slope of the function <span class="math inline">\(f(x)\)</span> is near <span class="math inline">\(0\)</span>, the approximate derivative can give strange results. Additionally, if you start with an <span class="math inline">\(x_1\)</span> that is too far away from your fixed point/root <span class="math inline">\(x^{*}\)</span>, the method will not converge.</p>
<p>Using a similar analysis as we would use with Newton’s method (namely Taylor’s series and mean value theorem), we ultimately get a convergence expression of <span class="math display">\[
\begin{align*}
    C = \frac{|x_{n + 1} - x^{*}|}{|x_n - x^{*}|^{\frac{1 + \sqrt{5} }{2}}}
\end{align*}
\]</span> which represents convergence of order <span class="math inline">\(\frac{1 + \sqrt{5}}{2}\)</span>. Although this is slower than Newton’s method, it is still faster than linear (order 1) and is thus faster than a method like bisection method.</p>
</section>
</section>
<section id="regula-falsi" class="level2">
<h2 class="anchored" data-anchor-id="regula-falsi">Regula Falsi</h2>
<p>The secant method addresses the requirement for a closed form derivative <span class="math inline">\(f'(x)\)</span> to be used in Newton’s method, it does not solve the sensitivity to the initial starting point.</p>
<p>The “regula falsi” method can be viewed as a further extension of the secant method which is guaranteed to converge to the true root <span class="math inline">\(x^{*}\)</span> by “bracketing” the root like the bisection method (i.e.&nbsp;always considering an interval <span class="math inline">\([a,b]\)</span> for which <span class="math inline">\(f(a)f(b) &lt; 0\)</span>). To do so, it adjusts the bisection method midpoint selection using a secant line: <span class="math display">\[
\begin{align*}
    f'(b) \approx \frac{f(b) - f(a)}{b - a}
.\end{align*}
\]</span> This line is then applied to finding a “pseudo-midpoint” <span class="math inline">\(c\)</span> that is between <span class="math inline">\(a\)</span> and <span class="math inline">\(b\)</span>: <span class="math display">\[
\begin{align*}
    c &amp;= b - \frac{f(b)}{f'(b)} \\
    &amp;\approx b - f(b) \frac{b - a}{f(b) - f(a)}
.\end{align*}
\]</span> After computing the “midpoint” <span class="math inline">\(c\)</span>, we can check <span class="math inline">\(f(a)f(c) &lt; 0\)</span> and adjust the interval <span class="math inline">\([a,b]\)</span> accordingly.</p>
<section id="pseudocode-1" class="level3">
<h3 class="anchored" data-anchor-id="pseudocode-1">Pseudocode</h3>
<p>Given the initial interval <span class="math inline">\([a,b]\)</span>, the function <span class="math inline">\(f\)</span>, and an ending tolerance <span class="math inline">\(tol\)</span> (the size of the final interval), we compute:</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode matlab code-with-copy"><code class="sourceCode matlab"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co">% Create a function g that computes the midpoint using regula falsi formula</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a><span class="va">g</span> <span class="op">=</span> <span class="op">@</span>(<span class="va">a</span><span class="op">,</span><span class="va">b</span>) <span class="op">...</span></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="co">% While half the interval is bigger than the given accuracy tolerance</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="va">c</span> <span class="op">=</span> <span class="va">g</span>(<span class="va">a</span><span class="op">,</span><span class="va">b</span>)</span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="kw">while</span> <span class="op">|</span><span class="va">f</span>(<span class="va">c</span>)<span class="op">|</span> <span class="op">&gt;</span> <span class="va">tol</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a>    <span class="co">% c = g(a,b)</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a>    <span class="co">% If f(c) = 0, stop                  -- this would be lucky (c=root)!</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a>    <span class="co">% If f(a)f(c) &lt; 0, then b=c          -- the root is between a and c</span></span>
<span id="cb2-9"><a href="#cb2-9" aria-hidden="true" tabindex="-1"></a>    <span class="co">% Else, a=c                          -- the root is between c and b</span></span>
<span id="cb2-10"><a href="#cb2-10" aria-hidden="true" tabindex="-1"></a><span class="kw">end</span></span>
<span id="cb2-11"><a href="#cb2-11" aria-hidden="true" tabindex="-1"></a><span class="co">% The final c is an approximate root</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<p>Note that this is almost identical to the bisection method with an adjusted calculation of <span class="math inline">\(c\)</span>!</p>
</section>
<section id="convergence-1" class="level3">
<h3 class="anchored" data-anchor-id="convergence-1">Convergence</h3>
<p>The general concept of the regula falsi method is to use the secant line to identify a point much closer to the root than the bisection method could, while still bracketing the root and guaranteeing convergence. In that sense, it should share a similar convergence rate as the bisection method along with guaranteed convergence.</p>
<p>However, unlike the bisection method, the regula falsi method does not have a guaranteed amount that it will shrink the interval <span class="math inline">\([a,b]\)</span> at each step due to this new “pseudo-midpoint” selection. Thus, it can on occasion converge slower than the bisection method! This demonstrates the challenging trade-offs associated with numerical methods: improved convergence, computational cost, or speed may result in instability, lack of convergence, or more assumptions and vice versa.</p>
</section>
</section>
<section id="comparison-of-root-finding-methods" class="level2">
<h2 class="anchored" data-anchor-id="comparison-of-root-finding-methods">Comparison of root finding methods</h2>
<p>As we have explored in the previous sections, there are various pros and cons associated with each of the root finding methods we have discussed. These can be roughly summarized in the following table:</p>
<table class="table">
<colgroup>
<col style="width: 33%">
<col style="width: 33%">
<col style="width: 33%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;">Method</th>
<th style="text-align: center;">Pros</th>
<th style="text-align: center;">Cons</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">Bisection</td>
<td style="text-align: center;">Guaranteed to converge</td>
<td style="text-align: center;">Slow linear convergence</td>
</tr>
<tr class="even">
<td style="text-align: center;">Newton’s</td>
<td style="text-align: center;">Fast quadratic convergence</td>
<td style="text-align: center;">Need to know <span class="math inline">\(f'\)</span>, may not converge</td>
</tr>
<tr class="odd">
<td style="text-align: center;">Secant</td>
<td style="text-align: center;">Good superlinear convergence</td>
<td style="text-align: center;">May not converge</td>
</tr>
<tr class="even">
<td style="text-align: center;">Regula falsi</td>
<td style="text-align: center;">Usually superlinear convergence, guaranteed to converge</td>
<td style="text-align: center;">Can have very slow convergence</td>
</tr>
</tbody>
</table>
<p>To further illustrate these differences, consider the following plots and table showing the results of these methods on the function <span class="math inline">\(f(x) = (x-3)^3\sin(x) + 3.5\)</span> on the interval <span class="math inline">\([1,3]\)</span> using a tolerance of <span class="math inline">\(10^{-5}\)</span>:</p>
<table class="table">
<caption>Iteration results for: Bisection (<span class="math inline">\(a=1,b=3\)</span>), Newton’s (<span class="math inline">\(x_1=2\)</span>), Secant (<span class="math inline">\(x_1=1,x_2=2\)</span>), Regula Falsi (<span class="math inline">\(a=1,b=3\)</span>)</caption>
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"><span class="math inline">\(n\)</span></th>
<th style="text-align: center;"><span class="math inline">\(x_n\)</span></th>
<th style="text-align: center;"><span class="math inline">\(f(x_n)\)</span></th>
<th style="text-align: center;"><span class="math inline">\(x_n\)</span></th>
<th style="text-align: center;"><span class="math inline">\(f(x_n)\)</span></th>
<th style="text-align: center;"><span class="math inline">\(x_n\)</span></th>
<th style="text-align: center;"><span class="math inline">\(f(x_n)\)</span></th>
<th style="text-align: center;"><span class="math inline">\(x_n\)</span></th>
<th style="text-align: center;"><span class="math inline">\(f(x_n)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">2.00</td>
<td style="text-align: center;">2.59</td>
<td style="text-align: center;">2.00</td>
<td style="text-align: center;">2.59</td>
<td style="text-align: center;">1.00</td>
<td style="text-align: center;">-3.23</td>
<td style="text-align: center;">1.96</td>
<td style="text-align: center;">2.4</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">1.50</td>
<td style="text-align: center;">0.13</td>
<td style="text-align: center;">1.18</td>
<td style="text-align: center;">-2.10</td>
<td style="text-align: center;">2.00</td>
<td style="text-align: center;">2.59</td>
<td style="text-align: center;">1.54</td>
<td style="text-align: center;">0.4</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;">1.25</td>
<td style="text-align: center;">-1.58</td>
<td style="text-align: center;">1.48</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">1.55</td>
<td style="text-align: center;">4.83</td>
<td style="text-align: center;">1.48</td>
<td style="text-align: center;">0.0</td>
</tr>
<tr class="even">
<td style="text-align: center;">3</td>
<td style="text-align: center;">1.37</td>
<td style="text-align: center;">-0.71</td>
<td style="text-align: center;">1.47</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">1.45</td>
<td style="text-align: center;">-0.17</td>
<td style="text-align: center;">1.48</td>
<td style="text-align: center;">0.0</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">1.43</td>
<td style="text-align: center;">-0.28</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">1.48</td>
<td style="text-align: center;">0.004</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">5</td>
<td style="text-align: center;">1.46</td>
<td style="text-align: center;">-0.07</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">1.47</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="odd">
<td style="text-align: center;">6</td>
<td style="text-align: center;">1.48</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
<tr class="even">
<td style="text-align: center;">7</td>
<td style="text-align: center;">1.47</td>
<td style="text-align: center;">-0.02</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
</tr>
</tbody>
</table>
<p>It can be immediately recognized that Newton’s method converged to a very accurate solution most rapidly followed closely by Regula falsi then Secant and finally Bisection. It is impressive that Regula falsi was so quick but this is not always the case. In addition, we needed more information for Newton’s method and for Regula falsi.</p>
<p>To get a sense for how these results can change, consider <span class="math inline">\(f(x) = 2x^{3} - 4x^{2} + 3x\)</span> on the interval <span class="math inline">\([-1,2]\)</span> using a tolerance of <span class="math inline">\(1\times 10^{-2}\)</span>:</p>
<table class="table">
<caption>Iteration results for: Bisection (<span class="math inline">\(a=-1,b=2\)</span>), Newton’s (<span class="math inline">\(x_1=-1\)</span>), Secant (<span class="math inline">\(x_1=-1,x_2=0.5\)</span>), Regula Falsi (<span class="math inline">\(a=-1,b=2\)</span>)</caption>
<colgroup>
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
<col style="width: 11%">
</colgroup>
<thead>
<tr class="header">
<th style="text-align: center;"><span class="math inline">\(n\)</span></th>
<th style="text-align: center;"><span class="math inline">\(x_n\)</span></th>
<th style="text-align: center;"><span class="math inline">\(f(x_n)\)</span></th>
<th style="text-align: center;"><span class="math inline">\(x_n\)</span></th>
<th style="text-align: center;"><span class="math inline">\(f(x_n)\)</span></th>
<th style="text-align: center;"><span class="math inline">\(x_n\)</span></th>
<th style="text-align: center;"><span class="math inline">\(f(x_n)\)</span></th>
<th style="text-align: center;"><span class="math inline">\(x_n\)</span></th>
<th style="text-align: center;"><span class="math inline">\(f(x_n)\)</span></th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: center;">0</td>
<td style="text-align: center;">0.50</td>
<td style="text-align: center;">0.75</td>
<td style="text-align: center;">-1.00</td>
<td style="text-align: center;">-9.00</td>
<td style="text-align: center;">-1.00</td>
<td style="text-align: center;">-9.00</td>
<td style="text-align: center;">0.80</td>
<td style="text-align: center;">0.86</td>
</tr>
<tr class="even">
<td style="text-align: center;">1</td>
<td style="text-align: center;">-0.25</td>
<td style="text-align: center;">-1.03</td>
<td style="text-align: center;">-0.47</td>
<td style="text-align: center;">-2.50</td>
<td style="text-align: center;">-0.50</td>
<td style="text-align: center;">-2.75</td>
<td style="text-align: center;">0.64</td>
<td style="text-align: center;">0.80</td>
</tr>
<tr class="odd">
<td style="text-align: center;">2</td>
<td style="text-align: center;">0.13</td>
<td style="text-align: center;">0.32</td>
<td style="text-align: center;">-0.16</td>
<td style="text-align: center;">-0.59</td>
<td style="text-align: center;">-0.28</td>
<td style="text-align: center;">-1.19</td>
<td style="text-align: center;">0.50</td>
<td style="text-align: center;">0.75</td>
</tr>
<tr class="even">
<td style="text-align: center;">3</td>
<td style="text-align: center;">-0.06</td>
<td style="text-align: center;">-0.20</td>
<td style="text-align: center;">-0.02</td>
<td style="text-align: center;">-0.08</td>
<td style="text-align: center;">-0.11</td>
<td style="text-align: center;">-0.38</td>
<td style="text-align: center;">0.39</td>
<td style="text-align: center;">0.68</td>
</tr>
<tr class="odd">
<td style="text-align: center;">4</td>
<td style="text-align: center;">0.03</td>
<td style="text-align: center;">0.09</td>
<td style="text-align: center;">-0.00</td>
<td style="text-align: center;">-0.00</td>
<td style="text-align: center;">-0.03</td>
<td style="text-align: center;">-0.09</td>
<td style="text-align: center;">0.29</td>
<td style="text-align: center;">0.58</td>
</tr>
<tr class="even">
<td style="text-align: center;">5</td>
<td style="text-align: center;">-0.02</td>
<td style="text-align: center;">-0.05</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">-0.00</td>
<td style="text-align: center;">-0.01</td>
<td style="text-align: center;">0.21</td>
<td style="text-align: center;">0.47</td>
</tr>
<tr class="odd">
<td style="text-align: center;">6</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;">0.02</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">-0.00</td>
<td style="text-align: center;">-0.00</td>
<td style="text-align: center;">0.15</td>
<td style="text-align: center;">0.37</td>
</tr>
<tr class="even">
<td style="text-align: center;">7</td>
<td style="text-align: center;">-0.00</td>
<td style="text-align: center;">-0.01</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">0.10</td>
<td style="text-align: center;">0.27</td>
</tr>
<tr class="odd">
<td style="text-align: center;">8</td>
<td style="text-align: center;">0.00</td>
<td style="text-align: center;">0.01</td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;"></td>
<td style="text-align: center;">0.07</td>
<td style="text-align: center;">0.20</td>
</tr>
</tbody>
</table>
<p>In this example, the regula falsi method suffers from a small secant line and shrinks the interval by only about <span class="math inline">\(\frac{1}{3}\)</span> at each step making it much slower than the bisection method. Although this example was selected specifically to demonstrate this behavior (and it’s not a very common behavior), it is something to be aware of when selecting your root finding method.</p>
</section>
<section id="examples" class="level2">
<h2 class="anchored" data-anchor-id="examples">Examples</h2>
<p>The following is a Matlab function that takes in a function handle <code>f</code>, initial points <code>x1</code> and <code>x2</code>, a tolerance <code>tol</code>, and a max number of possible iterations <code>Nmax</code>. This function performs the secant method iteration until <span class="math inline">\(|f(x_n)| &lt; \text{tol}\)</span> and return all iterations <span class="math inline">\(x_n\)</span> as an array <code>xs</code>:</p>
<pre class="{matlab}"><code>%| output: false
%%file MySecantMethod.m
function [xs] = MySecantMethod(f, x1, x2, tol, Nmax)
    g = @(x1,x2) x2 - f(x2) * ((x2 - x1) / (f(x2) - f(x1)));
    xs = [x1,x2];
    err = Inf;
    while err &gt; tol
        xs = [xs g(xs(end-1), xs(end))];
        err = abs(f(xs(end)));
        if length(xs) &gt; Nmax
            return;
        end
    end
end</code></pre>
<p>Considering a function <span class="math inline">\(f(x) = (x-3)^3\sin(x) + 3.5\)</span>:</p>
<pre class="{matlab}"><code>f = @(x) (x - 3).^3 .* sin(x) + 3.5;
xdom = linspace(0, 4, 100);
y = f(xdom);
figure()
plot(xdom, y);
hold on; grid on
xlabel("x", 'Interpreter','latex'); ylabel("f(x)", 'Interpreter','latex');
legend("$(x-3)^3 \sin(x) + 3.5$", 'interpreter','latex')
hold off</code></pre>
<p>Applying this function to find an approximate root for the above function with initial points <span class="math inline">\(x_1 = 1\)</span> and <span class="math inline">\(x_2=2\)</span>, a tolerance <span class="math inline">\(10^{-5}\)</span>, and max number of iterations <code>Nmax=20</code>:</p>
<pre class="{matlab}"><code>xs = MySecantMethod(f, 1, 2, 1e-5, 20);
disp(xs)</code></pre>
<p>Repeating this procedure using starting points <span class="math inline">\(x_1 = 1\)</span> and <span class="math inline">\(x_2 = 3\)</span>:</p>
<pre class="{matlab}"><code>xs = MySecantMethod(f, 1, 3, 1e-5, 20);
disp(xs)</code></pre>
<p>Note that the results change very significantly between the two different initial conditions. In fact, they seem to no longer converge in the second case. This demonstrates the sensitivity of the secant method to the two initial guess points.</p>
<section id="regula-falsi-1" class="level3">
<h3 class="anchored" data-anchor-id="regula-falsi-1">Regula falsi</h3>
<p>The following is a Matlab function that takes in a function handle <code>f</code>, interval lower bound <code>a</code>, interval upper bound <code>b</code>, and a tolerance <code>tol</code>. This function performs the regula falsi iteration until <span class="math inline">\(|f(x_n)| &lt; \text{tol}\)</span> and return all iterations <span class="math inline">\(x_n\)</span> as an array <code>xs</code>:</p>
<pre class="{matlab}"><code>%| output: false
%%file MyRegulaFalsi.m
function [xs] = MyRegulaFalsi(f, a, b, tol)
    N = 0;
    xs = [];
    c = b - f(b) * ((b - a) / (f(b) - f(a)));
    while abs(f(c)) &gt; tol
        c = b - f(b) * ((b - a) / (f(b) - f(a)));
        xs(N+1) = c;
        if f(c) == 0
            return
        elseif f(a)*f(c) &lt; 0
            b = c;
        else
            a = c;
        end
        N = N + 1;
    end
end</code></pre>
<p>Applying the regula falsi function to find an approximate root for <span class="math inline">\(f(x) = (x-3)^3\sin(x) + 3.5\)</span> with interval <span class="math inline">\([1,3]\)</span> and a tolerance <span class="math inline">\(10^{-5}\)</span>:</p>
<pre class="{matlab}"><code>xs = MyRegulaFalsi(f, 1, 3, 1e-5);
disp(xs)</code></pre>
</section>
<section id="finding-a-quantile-of-a-probability-distributions" class="level3">
<h3 class="anchored" data-anchor-id="finding-a-quantile-of-a-probability-distributions">Finding a quantile of a probability distributions</h3>
<p>A very common computation in statistics is to find a “quantile” of a probability distribution. For example, say we have a normal distribution of the heights of people in the class given by the cumulative density function (CDF): <span class="math display">\[
\begin{align*}
    C(x) = \frac{1}{2}\left(1 + \text{erf}\left(\frac{x - \mu}{\sigma \sqrt{2}}\right)\right)
\end{align*}
\]</span> where <span class="math inline">\(C(x)\)</span> is the probability that someone in the class is shorter than height <span class="math inline">\(x\)</span> (ft) given the class has average height <span class="math inline">\(\mu\)</span> (ft) and standard deviation <span class="math inline">\(\sigma\)</span> (erf is the error function which is also called in Matlab).</p>
<p>The 95% “quantile” of this CDF is the height <span class="math inline">\(x\)</span> for which 95% of the class is shorter (i.e.&nbsp;the <span class="math inline">\(x^*\)</span> such that <span class="math inline">\(C(x^*) = 0.95\)</span> given <span class="math inline">\(\mu\)</span> and <span class="math inline">\(\sigma\)</span>). This computation is actually a root finding problem! All we need to do is find the root of the function: <span class="math display">\[
\begin{align*}
    f(x) = 0.95 - C(x)
.\end{align*}
\]</span> The derivative of this function can be written as: <span class="math display">\[
\begin{align*}
    f'(x) = - P(x)
\end{align*}
\]</span> where <span class="math inline">\(P\)</span> is the probability density function (PDF) of the normal distribution: <span class="math display">\[
\begin{align*}
    P(x) = \frac{1}{\sigma \sqrt{2\pi} }e^{-\frac{1}{2}\left(\frac{x - \mu}{\sigma}\right)^{2}}
.\end{align*}
\]</span></p>
<p>The following is a plot of the CDF for <span class="math inline">\(x\)</span> on the interval <span class="math inline">\([3, 8]\)</span> given <span class="math inline">\(\mu = 5.5\)</span> and <span class="math inline">\(\sigma = 0.35\)</span>.</p>
<pre class="{matlab}"><code>m = 5.5;
s = 0.35;
C = @(x) (1/2) .* (1 + erf((x - m) ./ (sqrt(2)*s)));
P = @(x) (1 ./ (s*sqrt(2*pi))) * exp( (-1/2) .* ((x - m) ./ s) .^ 2);
nquant = @(x) 0.95 - C(x);

xdom = linspace(3, 8);
% plot(xdom, P(xdom))
figure()
plot(xdom, C(xdom))
hold on
xlabel("x", 'Interpreter','latex');
ylabel("C(X)", 'Interpreter','latex');
grid on
hold off</code></pre>
<p>To Find the <span class="math inline">\(95\%\)</span> quantile of this CDF:</p>
<ul>
<li>Using Secant method with starting points <code>x1=4.5</code> and <code>x2=6</code>, tolerance <span class="math inline">\(10^{-5}\)</span>, and <code>Nmax=10</code>:</li>
</ul>
<pre class="{matlab}"><code>xs3 = MySecantMethod(nquant, 4.5, 6, 1e-5, 10);
disp(xs3);</code></pre>
<ul>
<li>Using regula falsi with interval <span class="math inline">\([4, 7]\)</span> and tolerance <span class="math inline">\(10^{-5}\)</span>:</li>
</ul>
<pre class="{matlab}"><code>xs4 = MyRegulaFalsi(nquant, 4, 7, 1e-5);
disp(xs4);</code></pre>


</section>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const disableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'prefetch';
    }
  }
  const enableStylesheet = (stylesheets) => {
    for (let i=0; i < stylesheets.length; i++) {
      const stylesheet = stylesheets[i];
      stylesheet.rel = 'stylesheet';
    }
  }
  const manageTransitions = (selector, allowTransitions) => {
    const els = window.document.querySelectorAll(selector);
    for (let i=0; i < els.length; i++) {
      const el = els[i];
      if (allowTransitions) {
        el.classList.remove('notransition');
      } else {
        el.classList.add('notransition');
      }
    }
  }
  const toggleGiscusIfUsed = (isAlternate, darkModeDefault) => {
    const baseTheme = document.querySelector('#giscus-base-theme')?.value ?? 'light';
    const alternateTheme = document.querySelector('#giscus-alt-theme')?.value ?? 'dark';
    let newTheme = '';
    if(darkModeDefault) {
      newTheme = isAlternate ? baseTheme : alternateTheme;
    } else {
      newTheme = isAlternate ? alternateTheme : baseTheme;
    }
    const changeGiscusTheme = () => {
      // From: https://github.com/giscus/giscus/issues/336
      const sendMessage = (message) => {
        const iframe = document.querySelector('iframe.giscus-frame');
        if (!iframe) return;
        iframe.contentWindow.postMessage({ giscus: message }, 'https://giscus.app');
      }
      sendMessage({
        setConfig: {
          theme: newTheme
        }
      });
    }
    const isGiscussLoaded = window.document.querySelector('iframe.giscus-frame') !== null;
    if (isGiscussLoaded) {
      changeGiscusTheme();
    }
  }
  const toggleColorMode = (alternate) => {
    // Switch the stylesheets
    const alternateStylesheets = window.document.querySelectorAll('link.quarto-color-scheme.quarto-color-alternate');
    manageTransitions('#quarto-margin-sidebar .nav-link', false);
    if (alternate) {
      enableStylesheet(alternateStylesheets);
      for (const sheetNode of alternateStylesheets) {
        if (sheetNode.id === "quarto-bootstrap") {
          toggleBodyColorMode(sheetNode);
        }
      }
    } else {
      disableStylesheet(alternateStylesheets);
      toggleBodyColorPrimary();
    }
    manageTransitions('#quarto-margin-sidebar .nav-link', true);
    // Switch the toggles
    const toggles = window.document.querySelectorAll('.quarto-color-scheme-toggle');
    for (let i=0; i < toggles.length; i++) {
      const toggle = toggles[i];
      if (toggle) {
        if (alternate) {
          toggle.classList.add("alternate");     
        } else {
          toggle.classList.remove("alternate");
        }
      }
    }
    // Hack to workaround the fact that safari doesn't
    // properly recolor the scrollbar when toggling (#1455)
    if (navigator.userAgent.indexOf('Safari') > 0 && navigator.userAgent.indexOf('Chrome') == -1) {
      manageTransitions("body", false);
      window.scrollTo(0, 1);
      setTimeout(() => {
        window.scrollTo(0, 0);
        manageTransitions("body", true);
      }, 40);  
    }
  }
  const isFileUrl = () => { 
    return window.location.protocol === 'file:';
  }
  const hasAlternateSentinel = () => {  
    let styleSentinel = getColorSchemeSentinel();
    if (styleSentinel !== null) {
      return styleSentinel === "alternate";
    } else {
      return false;
    }
  }
  const setStyleSentinel = (alternate) => {
    const value = alternate ? "alternate" : "default";
    if (!isFileUrl()) {
      window.localStorage.setItem("quarto-color-scheme", value);
    } else {
      localAlternateSentinel = value;
    }
  }
  const getColorSchemeSentinel = () => {
    if (!isFileUrl()) {
      const storageValue = window.localStorage.getItem("quarto-color-scheme");
      return storageValue != null ? storageValue : localAlternateSentinel;
    } else {
      return localAlternateSentinel;
    }
  }
  const darkModeDefault = false;
  let localAlternateSentinel = darkModeDefault ? 'alternate' : 'default';
  // Dark / light mode switch
  window.quartoToggleColorScheme = () => {
    // Read the current dark / light value 
    let toAlternate = !hasAlternateSentinel();
    toggleColorMode(toAlternate);
    setStyleSentinel(toAlternate);
    toggleGiscusIfUsed(toAlternate, darkModeDefault);
  };
  // Ensure there is a toggle, if there isn't float one in the top right
  if (window.document.querySelector('.quarto-color-scheme-toggle') === null) {
    const a = window.document.createElement('a');
    a.classList.add('top-right');
    a.classList.add('quarto-color-scheme-toggle');
    a.href = "";
    a.onclick = function() { try { window.quartoToggleColorScheme(); } catch {} return false; };
    const i = window.document.createElement("i");
    i.classList.add('bi');
    a.appendChild(i);
    window.document.body.appendChild(a);
  }
  // Switch to dark mode if need be
  if (hasAlternateSentinel()) {
    toggleColorMode(true);
  } else {
    toggleColorMode(false);
  }
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
      <ul class="footer-items list-unstyled">
    <li class="nav-item compact">
    <a class="nav-link" href="https://www.linkedin.com/in/connor-robertson-773ba8b1/">
      <i class="bi bi-linkedin" role="img">
</i> 
    </a>
  </li>  
    <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/cnrrobertson">
      <i class="bi bi-github" role="img">
</i> 
    </a>
  </li>  
</ul>
    </div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
<p>Connor Robertson, Copyright 2024</p>
</div>
  </div>
</footer>




</body></html>